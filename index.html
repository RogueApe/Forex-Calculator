<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- iOS support -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Pips Calculator (by VP)">
  <link rel="apple-touch-icon" href="icon.png">

  <link href="https://fonts.googleapis.com/css2?family=Comfortaa&display=swap" rel="stylesheet">

  <title>Forex Pips Calculator</title>
  <link rel="icon" href="icon.png" type="image/png">
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa&family=Poppins:wght@600&display=swap"
    rel="stylesheet" />

  <style>
    body {
      font-family: 'Comfortaa', sans-serif;
      background: url('bg.jpg') no-repeat center center fixed;
      background-size: cover;
      margin: 0;
      padding: 0;
      color: #000;
    }

    .container {
      max-width: 500px;
      margin: 30px auto;
      background-color: rgba(255, 255, 255, 0.92);
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.3);
    }

    h2 {
      text-align: center;
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-top: 12px;
    }

    input,
    select {
      width: 100%;
      padding: 10px;
      margin-top: 4px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-family: 'Comfortaa', sans-serif;
      color: #003399;
      box-sizing: border-box;
    }

    input[readonly] {
      background-color: #f2f2f2;
      color: black;
      font-weight: bold;
    }

    button {
      width: 100%;
      padding: 14px;
      background-color: #003399;
      color: white;
      border: none;
      border-radius: 5px;
      margin-top: 20px;
      font-family: 'Poppins', sans-serif;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    button:hover {
      background-color: #002080;
      box-shadow: 0 0 10px #003399;
    }

    .result {
      margin-top: 25px;
      padding: 15px;
      background: #f9f9f9;
      border-radius: 8px;
      border: 1px solid #ccc;
      animation: fadeIn 1s ease;
    }

    /* Add underline */
    .result h3 {
      margin-bottom: 10px;
      text-decoration: underline;
    }

    .result p span {
      font-weight: bold;
      display: inline-block;
      /* <-- this makes animation visible */
    }

    .highlight-green {
      color: #00b050;
    }

    .highlight-red {
      color: red;
    }

    /* Only apply color/animation to span values, not the whole resultBox text */
    .result span.risk-blue {
      color: #4285f4;
      animation: lightPulse 2s ease-out;
    }

    .result span.risk-orange {
      color: darkorange;
      animation: mildShake 1.25s ease;
    }

    .result span.risk-danger {
      color: red;
      animation: heavyShake 1.75s ease;
    }


    @keyframes fadeIn {
      from {
        opacity: 0;
      }

      to {
        opacity: 1;
      }
    }

    @keyframes lightPulse {
      0% {
        text-shadow: 0 0 4px #aaf;
      }

      50% {
        text-shadow: 0 0 12px #4285f4;
        transform: scale(1.03);
      }

      100% {
        text-shadow: none;
        transform: scale(1);
      }
    }

    /* update animation for medium and heavy */
    @keyframes mildShake {

      0%,
      100% {
        transform: translateX(0);
      }

      20% {
        transform: translateX(-6px);
      }

      40% {
        transform: translateX(6px);
      }

      60% {
        transform: translateX(-4px);
      }

      80% {
        transform: translateX(4px);
      }
    }

    @keyframes heavyShake {

      0%,
      100% {
        transform: translateX(0);
      }

      10% {
        transform: translateX(-10px);
      }

      20% {
        transform: translateX(10px);
      }

      30% {
        transform: translateX(-8px);
      }

      40% {
        transform: translateX(8px);
      }

      50% {
        transform: translateX(-6px);
      }

      60% {
        transform: translateX(6px);
      }
    }



    @media screen and (max-width: 768px) {
      .container {
        margin: 15px;
      }

      /* added to fix the small box issue on mobile devices */
      select {
        height: 48px;
        font-size: 16px;
      }
    }
  </style>


</head>

<body>
  <div class="container">
    <h2>Forex Pips Calculator</h2>

    <label>Currency Pair:</label>
    <select id="pair">
      <option value="xauusd">XAU/USD</option>
      <option value="eurusd">EUR/USD</option>
      <option value="gbpusd">GBP/USD</option>
      <option value="gbpjpy">GBP/JPY</option>
    </select>

    <label>Account Capital (USD):</label>
    <input type="number" id="capital" />

    <label>Conversion Rate (1 USD to MYR):</label>
    <input type="number" id="conversion" />

    <label>Lot Size:</label>
    <input type="number" id="lot" step="0.01" />

    <label>Entry Price:</label>
    <input type="number" id="entry" />

    <!-- Temporarily delete this as I don't need this input -->
    <!-- <label>Exit Price:</label>
    <input type="number" id="exit" /> -->

    <label>TP Price:</label>
    <input type="number" id="tp" />

    <label>SL Price:</label>
    <input type="number" id="sl" />

    <button onclick="calculate()">Calculate</button>

    <div class="result" id="resultBox" style="display:none;">
      <h3>Result</h3>
      <p>Pips: <span id="pips"></span></p>
      <p>RR Ratio: <span id="rr"></span></p>
      <p>Profit (USD): <span id="profitusd" class="highlight-green"></span></p>
      <p>Profit (MYR): <span id="profitmyr" class="highlight-green"></span></p>
      <p>Price Loss (USD): <span id="lossusd" class="highlight-red"></span></p>
      <p>Price Loss (MYR): <span id="lossmyr" class="highlight-red"></span></p>
      <p>Risk (by %): <span id="riskpercent"></span></p>
    </div>
  </div>

  <audio id="audioGood" src="good.mp3" preload="auto"></audio>
  <audio id="audioCaution" src="caution.mp3" preload="auto"></audio>
  <audio id="audioDanger" src="danger.mp3" preload="auto"></audio>

  <script>
    function calculate() {
      const pair = document.getElementById('pair').value;
      const capital = parseFloat(document.getElementById('capital').value);
      const conversion = parseFloat(document.getElementById('conversion').value);
      const lot = parseFloat(document.getElementById('lot').value);
      const entry = parseFloat(document.getElementById('entry').value);
      // const exit = parseFloat(document.getElementById('exit').value);
      const tp = parseFloat(document.getElementById('tp').value);
      const sl = parseFloat(document.getElementById('sl').value);

      let pips = 0;
      let profit = 0;
      let loss = 0;

      const calcPips = (a, b) => Math.abs(a - b);
      const calcRR = () => (!isNaN(tp) && !isNaN(sl)) ? (Math.abs(entry - tp) / Math.abs(entry - sl)).toFixed(2) : '-';

      /*     if (!isNaN(entry)) {
            let priceDiff = 0;
            if (!isNaN(exit)) priceDiff = calcPips(entry, exit);
            else if (!isNaN(tp)) priceDiff = calcPips(entry, tp); */

      if (!isNaN(entry)) {
        let priceDiff = 0;
        if (!isNaN(tp)) priceDiff = calcPips(entry, tp);

        switch (pair) {
          case "xauusd":
            pips = priceDiff * 10;
            profit = !isNaN(tp) ? pips * 10 * lot : 0;
            loss = !isNaN(sl) ? calcPips(entry, sl) * 10 * 10 * lot : 0;
            break;
          case "eurusd":
          case "gbpusd":
            pips = priceDiff * 10000;
            profit = !isNaN(tp) ? pips * 10 * lot : 0;
            loss = !isNaN(sl) ? calcPips(entry, sl) * 10000 * 10 * lot : 0;
            break;
          case "gbpjpy":
            pips = priceDiff * 1000;
            profit = !isNaN(tp) ? pips * 0.695 * lot : 0;
            loss = !isNaN(sl) ? calcPips(entry, sl) * 1000 * 0.695 * lot : 0;
            break;
        }
      }

      const rr = calcRR();
      const riskPercent = (loss > 0 && capital > 0) ? ((loss / capital) * 100).toFixed(2) : '-';
      const profitMYR = conversion && profit ? (profit * conversion).toFixed(2) : '-';
      const lossMYR = conversion && loss ? (loss * conversion).toFixed(2) : '-';

      document.getElementById('pips').textContent = pips.toFixed(2);
      document.getElementById('rr').textContent = rr;
      document.getElementById('profitusd').textContent = profit.toFixed(2);
      document.getElementById('profitmyr').textContent = profitMYR;
      document.getElementById('lossusd').textContent = loss.toFixed(2);
      document.getElementById('lossmyr').textContent = lossMYR;
      document.getElementById('riskpercent').textContent = riskPercent + '%';

      const riskClass = riskPercent === '-' ? '' :
        riskPercent <= 10 ? 'risk-blue' :
          riskPercent <= 25 ? 'risk-orange' : 'risk-danger';

      const audioGood = document.getElementById("audioGood");
      const audioCaution = document.getElementById("audioCaution");
      const audioDanger = document.getElementById("audioDanger");


      // update new animation 09 June 2025
      const resultBox = document.getElementById('resultBox');

      const spans = document.querySelectorAll('#resultBox span');

      // Remove all animation classes from spans
      spans.forEach(span => {
        span.classList.remove('risk-blue', 'risk-orange', 'risk-danger');
        void span.offsetWidth; // Force reflow to reset animation
      });

      // Apply the correct animation class based on risk %
      if (riskPercent <= 10) {
        spans.forEach(span => span.classList.add('risk-blue'));
        audioGood.play();
      } else if (riskPercent <= 25) {
        spans.forEach(span => span.classList.add('risk-orange'));
        audioCaution.play();
      } else {
        spans.forEach(span => span.classList.add('risk-danger'));
        audioDanger.play();
      }




      document.getElementById('resultBox').style.display = 'block';
    }
  </script>
</body>

</html>
